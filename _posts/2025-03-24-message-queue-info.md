---
title: Message Queue란?
description:
author: Choi Seon Ha
date: 2025-03-24 09:30:00 +0800
categories: [Development, Backend]
tags: [MessageQueue, backend]
pin: true
math: false
mermaid: fasle
---

메세지 큐는 애플리케이션 간의 비동기 통신을 가능하게 해주는 아키텍처입니다.

**“메세지를 일시적으로 저장하고 전달하기 위한 중간 공간”** 이라는 `개념` 입니다.

쉽게 말해, A라는 프로그램이 어떤 데이터를 보내고, B라는 프로그램이 나중에 그 데이터를 꺼내서 처리할 수 있게 해주는 중간 저장소 역할을 하는 것 입니다.

1. 비동기 통신
2. 느슨한 결합
3. 안정적인 메세지 전달
4. 네트워크, 서버, 마이크로서비스, 대용량 처리 등에 많이 사용

---

**## 기본 개념 정리**

**### 큐(Queue)?**

- 선입선출(FIFO: First-In-First-Out)구조
- 먼저 들어온 메세지가 먼저 나감

**### 메세지 큐?**

- 메세지를 저장하고 전달하는 시스템
- 프로듀서(Producer): 메세지를 큐에 보냄
- 컨슈머(Consumer): 큐에서 메세지를 꺼내 처리

---

**## 쓰는 이유**

**### 1. 비동기 처리**

- 메세지를 보낸 쪽은 바로 다음 일을 처리 가능

- 받는 쪽이 바로 처리하지 않아도 됨

**### 2. 서비스 간 결합도 감소**

- 서로 직접 호출하지 않고 큐를 통해 통신하므로 유연성 증가

**### 3. 부하 분산**

- 많은 요청이 몰려도 큐에 쌓아두고 순차적으로 처리 가능

**### 4. 신뢰성 있는 데이터 전달**

- 큐에 저장된 메세지는 영속성이 보장되어 데이터 손실 방지

`영속성: 프로그램의 실행이 종료되어도 사라지지 않는 데이터의 성질`

---

+-------------+ +----------+ +-------------+

| Producer | -----> | Queue | -----> | Consumer |

+-------------+ +----------+ +-------------+

---

### 대표적인 메시지 큐 종류

| 메시지 큐         | 특징                                          | 설명                                                      | 사용 예                    |
| ----------------- | --------------------------------------------- | --------------------------------------------------------- | -------------------------- |
| **RabbitMQ**      | AMQP 프로토콜 기반, 안정적, 라우팅 기능 우수  | 메시지 큐 기능을 제공하는 대표적인 오픈소스 툴. AMQP 기반 | 실시간 채팅, 결제 처리     |
| **Kafka**         | 대용량 처리에 적합, 로그 수집/스트리밍에 강점 | 고속 대용량 메시지 스트리밍 플랫폼. 메시지를 큐처럼 다룸  | 로그 수집, 실시간 분석     |
| **Redis Pub/Sub** | 간단한 메시지 전달, 성능 빠름, 영속성 없음    | AWS에서 제공하는 관리형 메시지 큐 서비스                  | 클라우드 앱 간 메시지 전달 |
| **Amazon SQS**    | AWS에서 제공하는 완전 관리형 메시지 큐        | 인메모리 기반의 간단한 메시지 큐 기능                     | 빠른 알림, 채팅방 구현 등  |

---

### 실제 예시 (웹 개발에서)

> 주문 처리 시스템

1. 사용자가 주문 → 주문 정보를 메세지 큐에 전달
2. 백엔드에서 메세지를 하나씩 꺼내 결제, 알림, 배송 처리

---

### 용어 요약

| 용어            | 의미                                                   |
| --------------- | ------------------------------------------------------ |
| **Producer**    | 메시지를 큐에 넣는 역할                                |
| **Consumer**    | 큐에서 메시지를 꺼내 처리                              |
| **Broker**      | 큐를 관리하고 전달하는 시스템 (Kafka, RabbitMQ 등)     |
| **Topic/Queue** | 메시지가 쌓이는 공간 (Kafka는 Topic, RabbitMQ는 Queue) |

---

### 메세지 큐 라이브러리를 혼용하여 사용 할 수 있을까?

| 조합                 | 실무에서 흔한가?                   | 설명                                                                      |
| -------------------- | ---------------------------------- | ------------------------------------------------------------------------- |
| **Kafka + Redis**    | ⚪ 꽤 있음                         | Kafka로 대용량 메시지를 처리하고, Redis로 빠르게 응답 또는 캐시/세션 처리 |
| **RabbitMQ + Redis** | ⚪ 간혹 있음                       | RabbitMQ로 메시지 전송, Redis로 Pub/Sub 또는 간단한 실시간 알림           |
| **Kafka + RabbitMQ** | 🔴 드묾                            | 목적이 비슷해서 굳이 둘 다 쓰는 일은 많지 않음                            |
| **Kafka + SQS**      | ⚪ 클라우드 기반 아키텍처에서 가능 | Kafka는 내부 시스템용, SQS는 외부 시스템과 통신용                         |
| **Redis만 사용**     | ⚪ 소규모 실시간 처리에는 흔함     | 구현이 간단하고 빠름, 대신 신뢰성이 부족함                                |

### 왜 혼용하여 사용할까?

1. 역할이 다르기 때문
   - Kafka: 대량 로그 수집, 이벤트 스트리밍, 신뢰성 중요
   - Redis: 빠른 실시간 알림, 캐시, 세션 공유 등 빠른 속도 중요
   - SQS: AWS 서비스 간 통합, 간단한 큐 처리
2. 성능과 목적을 분리하기 위해
   - Kafka로 수집한 로그를 Redis로 전달해 실시간 대시보드에 보여주는 구조 등
3. 마이크로서비스 구조에서는 서비스마다 적절한 기술 스택을 선택하기 때문
   - 어떤 서비스는 Kafka, 어떤 서비스는 Redis 사용

---

### 실전 예시

예시 1) Kafka + Redis Pub/Sub

```jsx
- Kafka: 주문 이벤트를 수집하고 분석 시스템에 전달
- Redis: 사용자에게 실시간으로 "주문 완료" 알림을 띄움
```

예시 2) Kafka + Amazon SQS

```jsx
- Kafka: 내부 서비스 간 비동기 이벤트 처리
- SQS: 외부 파트너사에게 메세지를 보내는 용도
```
